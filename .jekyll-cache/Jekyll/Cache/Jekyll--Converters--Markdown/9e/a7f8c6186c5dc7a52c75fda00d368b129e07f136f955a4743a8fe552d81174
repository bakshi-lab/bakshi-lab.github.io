I"-<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
});
</script>

<p>We’ve derived the 1D heat diffusion equation, so now let’s take a look at one of the solutions. This solution is for a symmetric rod. Simply, imagine a rod of some length $L$. This rod is insulated across its length so that no heat is lost to the atmosphere across that length.  The only place where the rod is not insulated is at the ends which will change temperature. We want to calculate how the temperature changes across the length of the rod in time when the temperature at the ends of the rod change.</p>

<p>Let’s recall the heat diffusion equation that we derived:</p>

\[\frac{\partial^2T}{\partial x^2} = \frac{1}{\alpha}\frac{\partial T}{\partial t}\]

<p>We want to find a solution for the temperature profile of the rod in time \textit{and} space. This would take the form of an equation:</p>

\[T=T(x,t)\]

<p>We want to find an equation for $T(x,t)$ where we can plug in the location within the rod and the time after the temperature change to find the temperature.</p>

<p>We will assume that the entire rod starts off at a uniform temperature $T_i$ at $t=0$, that is to say: $T_i=T(x,0)$. Then at an infinitesimal time after $t=0$, the edges ends of the rod immediately change temperature to $T_f$. Therefore $T_f = T(0,t&gt;0) = T(L,t&gt;0)$. One can imagine that after a long time the rod will reach one uniform temperature, because the side of the rod is insulated and no heat can be lost, the entire rod must reach thermal equilibrium with the rod ends. Therefore we can also say: $T_f = T(x,\infty)$</p>

<p>Notice we have just defined our boundary conditions. Let’s take another look:</p>

<p>Our temporal (initial) condition is the temperature of the ends of the rod at $t=0$
\(T_i=T(x,0)\)
And the two spacial boundary conditions refer to the two ends of the rod:
\(T_f = T(0,t&gt;0) = T(L,t&gt;0)\).</p>

<p>We can rewrite these another way which may make more sense:</p>

<ul>
    <li>At $t=0$, $T=T_i$ (temporal)</li>
    <li>At $x=0$, $T=T_f$ (spacial)</li>
    <li>At $x=L$, $T=T_f$ (spacial)</li>
</ul>

<p>In order to solve the differential equation for this problem it helps to non-dimensionalise our variables, which are $x$, time and temperature. We define our non-dimensional variables as follows:</p>

<p>\(\hat{T} = \frac{T-T_f}{T_i-T_f}\)
\(\hat{x}=\frac{x}{L}\)
\(\hat{t}=\frac{\alpha}{L^2}t\)</p>

<p>I will not discuss how to non-dimensionalise the variables here, instead you can see \textbf{this} article.</p>

<p>The PDE now looks like this:
\(\frac{\partial^2\hat{T}}{\partial \hat{x}^2} = \frac{\partial \hat{T}}{\partial \hat{t}}\)</p>

<p>Why did we just do this? It makes solving the PDE mathematically easier because now the initial temperature is $\hat{T_i} = 1$ and the final temperature is $\hat{T_f} = 0$, the initial length is $\hat{x} = 0$, the final length is $\hat{x}=1$ and the initial time is $\hat{t} = 0$.</p>

<p>Let’s rewrite our boundary conditions in non-dimensional form:</p>

<ul>
    <li>At $\hat{t}=0$, $\hat{T}=1$ (temporal)</li>
    <li>At $\hat{x}=0$, $T=0$ (spacial)</li>
    <li>At $\hat{x}=1$, $T=0$ (spacial)</li>
</ul>

<p>We will now use a technique called \textbf{separation of variables} to solve this PDE in non-dimensional form. This means that we are going to assume that there exists a solution to the differential which is the product of two functions which each are a function only of either space or time.</p>

<p>Let’s unpack that. Recall that we want a solution which describes temperature in space and time like so: $\hat{T} = \hat{T}(\hat{x},\hat{t})$. We are going to assume that we can write $\hat{T}(\hat{x},\hat{t})$ (which is a two-variable function) as the product of two one-variable functions like so:</p>

\[\hat{T}(\hat{x},\hat{t}) = \beta (\hat{x}) \cdot \gamma(\hat{t})\]

<p>Where $\beta (\hat{x})$ is some function of $\hat{x}$ alone, and $\gamma(\hat{t})$ is a function only of $\hat{t}$. Multiplying these two functions together gives our two-variable function which is our solution.</p>

<p>We are now going to look at the left hand side of our PDE: $\frac{\partial^2\hat{T}}{\partial \hat{x}^2}$, notice that this is what we get if we differentiate $\hat{T}(\hat{x},\hat{t})$ twice with respect to $\hat{x}$ whilst keeping $\hat{t}$ constant:</p>

\[\frac{\partial^2\hat{T}}{\partial \hat{x}^2} = \frac{\partial^2}{\partial \hat{x}^2}\big[\beta (\hat{x}) \cdot \gamma(\hat{t})\big]\bigg|_{\hat{t}}\]

<p>Because $\gamma(\hat{t})$ is being treated as a constant, we can easily apply the product rule when differentiating, and so we get</p>

\[\frac{\partial^2\hat{T}}{\partial \hat{x}^2} = \beta''(\hat{x}) \cdot \gamma(\hat{t})\]

<p>Where $\beta’’(\hat{x}) = \frac{d^2 \beta(\hat{x})}{d\hat{x}^2}$. Notice it’s a normal derivative because $\beta$ can only be differentiated with respect to $\hat{x}$ because it is a function of $\hat{x}$ only.</p>

<p>Moving on to the right hand side of the PDE we see that</p>

\[\frac{\partial \hat{T}}{\partial \hat{t}} = \frac{\partial}{\partial \hat{t}}\big[\beta (\hat{x}) \cdot \gamma(\hat{t})\big]\bigg|_{\hat{x}}\]

<p>Again applying the product rule we get</p>

\[\frac{\partial \hat{T}}{\partial \hat{t}} = \beta (\hat{x}) \cdot \gamma'(\hat{t})\]

<p>Substituting both of these results into the original PDE we get an interesting equation composed only of single-variable functions:</p>

\[\beta (\hat{x}) \cdot \gamma'(\hat{t}) = \beta''(\hat{x}) \cdot \gamma(\hat{t})\]

<p>Which can be re-written as:</p>

\[\frac{\gamma'(\hat{t})}{\gamma(\hat{t})} = \frac{\beta''(\hat{x})}{\beta (\hat{x})} = -\lambda^2\]

<p>Why did I equate this equation to a constant $-\lambda^2$? Well we know that each side of the equation is actually a constant because the left hand side of the equation is a function of $\hat{t}$ only, meaning that changing that side cannot affect the right hand side of the equation which is a function only of $\hat{x}$ and vice versa. Okay then, well why is the constant negative? Why is it squared? You will see further on why choosing a negative constant is the only one which can give you an answer which makes sense in the real world, and squaring it simply makes the maths more convenient.</p>

<p>Anyway - we now have two equations which are easy to solve independently:</p>

<ul>
    <li> $\frac{\gamma'(\hat{t})}{\gamma(\hat{t})} = -\lambda^2$ </li>
    <li> $\frac{\beta''(\hat{x})}{\beta (\hat{x})} = -\lambda^2$ </li>
</ul>

<p>Let’s solve the first by re-arranging and integrating directly:</p>

\[\frac{d\gamma(\hat{t})}{d\hat{t}}=-\lambda^2\gamma(\hat{t})\]

\[\int\frac{d\gamma(\hat{t})}{\gamma(\hat{t})}=-\lambda^2\int d\hat{t}\]

\[ln(\gamma(\hat{t})) + C_0 = -\lambda^2 \hat{t}\]

<p>Combining the constant and exponentiating:</p>

\[\gamma(\hat{t})=C_1 e^{-\lambda^2 \hat{t}}\]

<p>Integrating the second function is a little bit more involved. Let’s rearrange it:</p>

\[\beta''(\hat{x}) + \lambda^2\beta (\hat{x}) = 0\]

<p>This is a \textbf{homogeneous 2nd order ordinary differential equation with constant coefficients}, this means we can guess a solution of the form $\beta = e^{k\hat{x}}$. Let’s plug this solution into the ODE:</p>

\[k^2 e^{k\hat{x}} + \lambda^2 e^{k\hat{x}} = 0\]

<p>Notice how the exponential terms drop out and we are left with:</p>

\[k^2 + \lambda^2 = 0 \rightarrow k^2 = -\lambda^2\]

<p>Therefore</p>

\[k=\pm i \lambda\]

<p>We can now take linear combinations of the solution as we have two of them (the $\pm i \lambda$)</p>

<p>We can write</p>

\[\beta(\hat{x})=Ae^{i\lambda\hat{x}} + Be^{-i\lambda\hat{x}}\]

<p>Recall Euler’s identity which states that $e^{i\theta}=\cos(\theta)+i\sin(\theta)$</p>

<p>We can substitute this into our general solution for $\beta$ and we get the following:</p>

\[\beta(\hat{x}) = A(\cos(\lambda x) + i\sin(\lambda x))+B(\cos(-\lambda x) + i\sin(-\lambda x))\]

<p>Noting sin and cos properties:</p>

\[\beta(\hat{x}) = A(\cos(\lambda x) + i\sin(\lambda x))+B(\cos(\lambda x) - i\sin(\lambda x))\]

<p>Collecting terms:</p>

\[\beta(\hat{x}) = \cos(\lambda x)(A+B) + i\sin(\lambda x)(A-B)\]

<p>And collecting constants into new ones:</p>

\[\beta(\hat{x}) = C_2\cos(\lambda x) + C_3\sin(\lambda x)\]

<p>We now have a general solution for $\hat{T}$!</p>

\[\hat{T}(\hat{x},\hat{t})=C_1 e^{-\lambda^2 \hat{t}} (C_2\cos(\lambda \hat{x}) + C_3\sin(\lambda \hat{x}))\]

<p>Now we must substitute in our boundary conditions to find the final solution.</p>

<p>Let’s apply the boundary conditions:
At $\hat{x}=0$, $\hat{T}=0$ (spacial)</p>

\[0=\hat{T}(0,\hat{t})=C_1 e^{-\lambda^2 \hat{t}} (C_2\cos(0) + C_3\sin(0))\]

<p>For this to be satisfied, $C_2 = 0$. Therefore we now have</p>

\[\hat{T}(\hat{x},\hat{t})=C_1 e^{-\lambda^2 \hat{t}}C_3\sin(\lambda \hat{x})\]

<p>$\hat{x}=1$, $\hat{T}=0$ (spacial)</p>

\[0=\hat{T}(1,\hat{t})=C_1 e^{-\lambda^2 \hat{t}}C_3\sin(\lambda)\]

<p>Therefore $C_3\sin(\lambda) = 0$ because the exponential cannot equal 0. This is true when $\lambda=n\pi$. Taking linear combinations of solutions we get</p>

\[\hat{T}(\hat{x},\hat{t})=C_1 e^{-\lambda^2 \hat{t}}\sum_{n=1}^{\infty}C_n \sin(n\pi \hat{x})\]

<p>And finally:
At $\hat{t}=0$, $\hat{T}=1$ (temporal)</p>

\[1=\hat{T}(\hat{x},0)=C_1\sum_{n=1}^{\infty}C_n \sin(n\pi \hat{x})\]

<p>Therefore $C_1 = 1$. We get a final solution of:</p>

\[\hat{T}(\hat{x},\hat{t})=\sum_{n=1}^{\infty}C_n  e^{-n^2\pi^2 \hat{t}} \sin(n\pi \hat{x})\]

<p>Now we must find the the constants $C_n$, we will use the property that:</p>

\[\int_{0}^{1}  \sin(n\pi \hat{x})  \sin(n\pi \hat{x})d\hat{x} = 0 \ except \ when \ n=\hat{x}\]

<p>Now we apply the temporal (initial) boundary condition:</p>

\[1=\hat{T}(\hat{x},0)=\sum_{n=1}^{\infty}C_n \sin(n\pi \hat{x})\]

<p>Multiplying each side of this equation by $\sin(n\pi \hat{x})$ and integrating between limits yields:</p>

\[\int_{0}^{1}  \sin(n\pi \hat{x})d\hat{x} = \sum_{n=1}^{\infty}C_n \int_{0}^{1} \sin(n\pi \hat{x})\sin(n\pi \hat{x})d\hat{x}\]

<p>Notice that the only terms in this infinite sum that will not be zero integrated are when $n=\hat{x}$, therefore we get a formula for the unknown coefficients:</p>

\[C_n = \frac{\int_{0}^{1} \sin(n\pi\hat{x})}{\int_{0}^{1}\sin^2(n\pi\hat{x})}\]

<p>For the denominator recall that $\sin^2(x)=\frac{1}{2}[1-\cos(2x)]$	and therefore</p>

\[\int_{0}^{1}\sin^2(n\pi\hat{x})d\hat{x} = \frac{1}{2}\int_{0}^{1}[1-\cos(2n\pi\hat{x})]d\hat{x}\]

<p>If you evaluate the right hand integral you find that:</p>

\[\int_{0}^{1}\sin^2(n\pi\hat{x})d\hat{x} = \bigg[\frac{\hat{x}}{2}-\frac{\sin(2n\pi \hat{x})}{2n\pi}\bigg]^1_0=\frac{1}{2}\]

<p>So</p>

\[C_n = 2 \int_{0}^{1} \sin(n\pi\hat{x}) d\hat{x} = 2\bigg[\frac{-\cos(n\pi \hat{x})}{2n\pi}\bigg]^1_0\]

\[C_n = \frac{2}{n\pi}(1-(-1)^n)\]

<p>So it can be seen that the coefficients are:</p>

\[C_1 = \frac{4}{\pi}, \ C_2 = 0, \ C_3 = \frac{4}{3\pi},\  C_4 = 0, \  C_5 = \frac{4}{5\pi}\dots\]

<p>Note that $C_1$ is not the same constant mentioned earlier.</p>

<p>Substituting these coefficients into the final solution we get our (more) final solution:</p>

\[\hat{T}(\hat{x},\hat{t})=\sum_{n=1}^{\infty}\frac{2}{n\pi}(1-(-1)^n)  e^{-n^2\pi^2 \hat{t}} \sin(n\pi \hat{x})\]

<p>Or</p>

\[\hat{T}(\hat{x},\hat{t}) = \frac{4}{\pi}\bigg(e^{-\pi^2\hat{x}}\sin(\pi \hat{x}) +
\frac{1}{3}e^{-9\pi^2\hat{x}}\sin(3\pi \hat{x}) +
\frac{1}{5}e^{-25\pi^2\hat{x}}\sin(5\pi \hat{x})\dots\bigg)\]
:ET